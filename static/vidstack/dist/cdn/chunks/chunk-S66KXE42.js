import { B, r, q, p as p$1 } from './chunk-NHJRSSLH.js';
import { E, v as v$1, F, x as x$1 } from './chunk-OQQW4RVA.js';
import { h } from './chunk-KZR5HH3N.js';

var g=Symbol(0),c=Symbol(0),_=Symbol(0),R=Symbol(0),A=Symbol(0),p=Symbol(0),P=Symbol(0);var S,K,O,m=class extends E{constructor(e){super();this.id="";this.label="";this.language="";this.default=!1;this.fe=!1;this.Ce=0;this.ie="disabled";this.Ie={};this.$e=[];this.ne=[];this.pe=[];this[S]=0;this[K]=null;this[O]=null;for(let t of Object.keys(e))this[t]=e[t];e.src||(this[c]=2);}static createId(e){return `id::${e.type}-${e.kind}-${e.src??e.label}`}get metadata(){return this.Ie}get regions(){return this.$e}get cues(){return this.ne}get activeCues(){return this.pe}get readyState(){return this[c]}get mode(){return this.ie}set mode(e){this.setMode(e);}addCue(e,t){let r=0,i=this.ne.length;for(r=0;r<i&&!(e.endTime<=this.ne[r].startTime);r++);r===i?this.ne.push(e):this.ne.splice(r,0,e),t?.type!=="cuechange"&&this[p]?.track.addCue(e),this.dispatchEvent(new v$1("add-cue",{detail:e,trigger:t})),e.startTime>=this.Ce&&e.endTime<=this.Ce&&this[_](this.Ce,t);}removeCue(e,t){let r=this.ne.indexOf(e);if(r>=0){let i=this.pe.includes(e);this.ne.splice(r,1),this[p]?.track.removeCue(e),this.dispatchEvent(new v$1("remove-cue",{detail:e,trigger:t})),i&&this[_](this.Ce,t);}}setMode(e,t){this.ie!==e&&(this.ie=e,e==="disabled"?(this.pe=[],this.De()):this.Oe(),this.dispatchEvent(new v$1("mode-change",{detail:this,trigger:t})),this[A]?.());}[(S=c,K=A,O=p,_)](e,t){if(this.Ce=e,this.mode==="disabled"||!this.ne.length)return;let r=[];for(let n=0,o=this.ne.length;n<o;n++){let d=this.ne[n];e>=d.startTime&&e<=d.endTime&&r.push(d);}let i=r.length!==this.pe.length;if(!i){for(let n=0;n<r.length;n++)if(!this.pe.includes(r[n])){i=!0;break}}this.pe=r,i&&this.De(t);}[R](){this.fe=!0,this.ie!=="disabled"&&this.Oe();}async Oe(){if(!(!this.fe||!this.src||this[c]>0)){this[c]=1,this.dispatchEvent(new v$1("load-start"));try{let{parseResponse:e}=await import('./prod-UQ2X4O6M.js'),{errors:t,metadata:r,regions:i,cues:n}=await e(fetch(this.src),{type:this.type,encoding:this.encoding});if(t[0]?.code===0)throw t[0];{this.Ie=r,this.$e=i,this.ne=n,this[c]=2;let o=this[p]?.track;if(o)for(let d of this.ne)o.addCue(d);this.dispatchEvent(new v$1("load"));}}catch(e){this[c]=3,this.dispatchEvent(new v$1("error",{detail:e}));}}}De(e){this.dispatchEvent(new v$1("cue-change",{trigger:e}));}},I=/captions|subtitles/;function U(a){return I.test(a.kind)}function b(a,s){a.textTracks.onaddtrack=e=>{let t=e.track;if(!t||H(a,t))return;let r=new m({id:t.id,kind:t.kind,label:t.label,language:t.language,type:"vtt"});r[p]={track:t},r[c]=2,r[P]=!0;let i=0,n=o=>{if(t.cues)for(let d=i;d<t.cues.length;d++)r.addCue(t.cues[d],o),i++;};n(e),t.oncuechange=n,s.textTracks.add(r,e),r.setMode(t.mode,e);},h(()=>{a.textTracks.onaddtrack=null;for(let e of s.textTracks){let t=e[p]?.track;t?.oncuechange&&(t.oncuechange=null);}});}function H(a,s){return Array.from(a.children).find(e=>e.track===s)}var v=class{constructor(s,{delegate:e}){this.ee=s;let t=(r,i)=>{e.dispatch("picture-in-picture-change",{detail:r,trigger:i});};F(this.ee,"enterpictureinpicture",r=>t(!0,r)),F(this.ee,"leavepictureinpicture",r=>t(!1,r));}get active(){return document.pictureInPictureElement===this.ee}get supported(){return q(this.ee)}async enter(){return this.ee.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}};var f=class{constructor(s,{$player:e,logger:t,delegate:r}){this.ee=s;this.ie="inline";F(this.ee,"webkitpresentationmodechanged",i=>{let n=this.ie;this.ie=this.ee.webkitPresentationMode,x$1(e(),"video-presentation-change",{detail:this.ie,trigger:i}),["fullscreen","picture-in-picture"].forEach(o=>{(this.ie===o||n===o)&&r.dispatch(`${o}-change`,{detail:this.ie===o,trigger:i});});});}get Qe(){return r(this.ee)}async Se(s){this.ie!==s&&this.ee.webkitSetPresentationMode(s);}},x=class{constructor(s){this.le=s;}get active(){return this.le.ie==="fullscreen"}get supported(){return this.le.Qe}async enter(){this.le.Se("fullscreen");}async exit(){this.le.Se("inline");}},C=class{constructor(s){this.le=s;}get active(){return this.le.ie==="picture-in-picture"}get supported(){return this.le.Qe}async enter(){this.le.Se("picture-in-picture");}async exit(){this.le.Se("inline");}};var L=Symbol(0),w,D=class extends B{constructor(e,t){super(e);this[w]=!0;if(r(e)){let r=new f(e,t);this.fullscreen=new x(r),this.pictureInPicture=new C(r);}else q(e)&&(this.pictureInPicture=new v(e,t));}get type(){return "video"}setup(e){super.setup(e),p$1(this.video)&&b(this.video,e),e.textRenderers[g](this.video),h(()=>{e.textRenderers[g](null);}),this.type==="video"&&e.delegate.dispatch("provider-setup",{detail:this});}get video(){return this.oe}};w=L;

export { g as a, c as b, _ as c, R as d, A as e, p as f, P as g, m as h, U as i, L as j, D as k };
